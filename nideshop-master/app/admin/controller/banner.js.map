{
    "version": 3,
    "sources": [
        "../../../src/admin/controller/banner.js"
    ],
    "names": [
        "module",
        "exports",
        "think",
        "Controller",
        "indexAction",
        "banner",
        "model",
        "where",
        "ad_position_id",
        "select",
        "success",
        "addAction",
        "isPost",
        "id",
        "post",
        "values",
        "media_type",
        "name",
        "link",
        "image_url",
        "content",
        "end_time",
        "enabled",
        "update",
        "add",
        "infoAction",
        "get",
        "data",
        "find",
        "deleteAction",
        "limit",
        "delete"
    ],
    "mappings": ";;AAAAA,OAAOC,OAAP,GAAiB,cAAcC,MAAMC,UAApB,CAA+B;AAC9C;;;;AAIMC,aAAN,GAAoB;AAAA;;AAAA;AAClB,YAAMC,SAAS,MAAM,MAAKC,KAAL,CAAW,IAAX,EAAiBC,KAAjB,CAAuB,EAACC,gBAAgB,CAAjB,EAAvB,EAA4CC,MAA5C,EAArB;AACA,aAAO,MAAKC,OAAL,CAAaL,MAAb,CAAP;AAFkB;AAGnB;;AAED;;;;;;;;;;;;;;;;;;AAkBMM,WAAN,GAAkB;AAAA;;AAAA;AAChB,UAAI,CAAC,OAAKC,MAAV,EAAkB;AAChB,eAAO,KAAP;AACD;AACD,YAAMC,KAAK,OAAKC,IAAL,CAAU,IAAV,CAAX;;AAEA,YAAMR,QAAQ,OAAKA,KAAL,CAAW,IAAX,CAAd;;AAEA,UAAIS,SAAS;AACXP,wBAAe,CADJ;AAEXQ,oBAAW,CAFA;AAGXC,cAAK,OAAKH,IAAL,CAAU,MAAV,CAHM;AAIXI,cAAK,EAJM;AAKXC,mBAAU,OAAKL,IAAL,CAAU,WAAV,CALC;AAMXM,iBAAS,OAAKN,IAAL,CAAU,SAAV,CANE;AAOXO,kBAAU,CAPC;AAQXC,iBAAS,OAAKR,IAAL,CAAU,SAAV,IAAsB,CAAtB,GAAyB;AARvB,OAAb;AAUA,UAAID,KAAK,CAAT,EAAY;AACV,cAAMP,MAAMC,KAAN,CAAY,EAACM,IAAIA,EAAL,EAAZ,EAAsBU,MAAtB,CAA6BR,MAA7B,CAAN;AACD,OAFD,MAEO;AACL,eAAOA,OAAOF,EAAd;AACA,cAAMP,MAAMkB,GAAN,CAAUT,MAAV,CAAN;AACD;AACD,aAAO,OAAKL,OAAL,CAAaK,MAAb,CAAP;AAxBgB;AAyBjB;;AAEKU,YAAN,GAAkB;AAAA;;AAAA;AAChB,YAAMZ,KAAK,OAAKC,IAAL,CAAU,IAAV,KAAmB,OAAKY,GAAL,CAAS,IAAT,CAA9B;;AAEA,YAAMpB,QAAQ,OAAKA,KAAL,CAAW,IAAX,CAAd;AACA,YAAMqB,OAAO,MAAMrB,MAAMC,KAAN,CAAY,EAACM,IAAIA,EAAL,EAAZ,EAAsBe,IAAtB,EAAnB;AACA,aAAO,OAAKlB,OAAL,CAAaiB,IAAb,CAAP;AALgB;AAMjB;;AAGD;;;;AAIME,cAAN,GAAqB;AAAA;;AAAA;AACnB,YAAMhB,KAAK,OAAKC,IAAL,CAAU,IAAV,CAAX;AACA,YAAM,OAAKR,KAAL,CAAW,IAAX,EAAiBC,KAAjB,CAAuB,EAACM,IAAIA,EAAL,EAAvB,EAAiCiB,KAAjC,CAAuC,CAAvC,EAA0CC,MAA1C,EAAN;;AAEA;;AAEA,aAAO,OAAKrB,OAAL,EAAP;AANmB;AAOpB;AA3E6C,CAAhD",
    "file": "../../../src/admin/controller/banner.js",
    "sourcesContent": [
        "module.exports = class extends think.Controller {\n  /**\n   * 获取banner信息\n   * @returns {Promise<void>}\n   */\n  async indexAction() {\n    const banner = await this.model('ad').where({ad_position_id: 1}).select();\n    return this.success(banner);\n  }\n\n  /**\n   * CREATE TABLE `nideshop_ad` (\n   `id` smallint(5) unsigned NOT NULL AUTO_INCREMENT,\n   `ad_position_id` smallint(5) unsigned NOT NULL DEFAULT '0',\n   `media_type` tinyint(3) unsigned NOT NULL DEFAULT '0',\n   `name` varchar(60) NOT NULL DEFAULT '',\n   `link` varchar(255) NOT NULL DEFAULT '',\n   `image_url` text NOT NULL,\n   `content` varchar(255) NOT NULL DEFAULT '',\n   `end_time` int(11) NOT NULL DEFAULT '0',\n   `enabled` tinyint(3) unsigned NOT NULL DEFAULT '1',\n   PRIMARY KEY (`id`),\n   KEY `position_id` (`ad_position_id`),\n   KEY `enabled` (`enabled`)\n   ) ENGINE=InnoDB AUTO_INCREMENT=4 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci COMMENT='banner图表\\n';\n   * 添加一个banner\n   * @returns {Promise<void>}\n   */\n  async addAction() {\n    if (!this.isPost) {\n      return false;\n    }\n    const id = this.post('id');\n\n    const model = this.model('ad');\n\n    let values = {\n      ad_position_id:1,\n      media_type:1,\n      name:this.post('name'),\n      link:'',\n      image_url:this.post('image_url'),\n      content: this.post('content'),\n      end_time: 0,\n      enabled: this.post('enabled')? 1: 0\n    };\n    if (id > 0) {\n      await model.where({id: id}).update(values);\n    } else {\n      delete values.id;\n      await model.add(values);\n    }\n    return this.success(values);\n  }\n\n  async infoAction(){\n    const id = this.post('id') || this.get('id');\n\n    const model = this.model('ad');\n    const data = await model.where({id: id}).find();\n    return this.success(data);\n  }\n\n\n  /**\n   * 删除一个banner\n   * @returns {Promise<void>}\n   */\n  async deleteAction() {\n    const id = this.post('id');\n    await this.model('ad').where({id: id}).limit(1).delete();\n\n    // TODO 事务，验证订单是否可删除（只有失效的订单才可以删除）\n\n    return this.success();\n  }\n};\n"
    ]
}