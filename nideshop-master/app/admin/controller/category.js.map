{
    "version": 3,
    "sources": [
        "../../../src/admin/controller/category.js"
    ],
    "names": [
        "Base",
        "require",
        "module",
        "exports",
        "indexAction",
        "model",
        "data",
        "where",
        "order",
        "select",
        "topCategory",
        "filter",
        "item",
        "parent_id",
        "categoryList",
        "map",
        "level",
        "push",
        "child",
        "id",
        "success",
        "secondAction",
        "is_show",
        "second",
        "topCategoryAction",
        "infoAction",
        "get",
        "find",
        "storeAction",
        "isPost",
        "values",
        "post",
        "datas",
        "name",
        "keywords",
        "front_desc",
        "sort_order",
        "show_index",
        "banner_url",
        "icon_url",
        "img_url",
        "wap_banner_url",
        "type",
        "front_name",
        "update",
        "add",
        "destoryAction",
        "limit",
        "delete"
    ],
    "mappings": "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",
    "file": "../../../src/admin/controller/category.js",
    "sourcesContent": [
        "const Base = require('./base.js');\n\nmodule.exports = class extends Base {\n  /**\n   * index action\n   * @return {Promise} []\n   */\n  async indexAction() {\n    const model = this.model('category');\n    const data = await model.where().order(['sort_order ASC']).select();\n    const topCategory = data.filter((item) => {\n      return item.parent_id === 0;\n    });\n    const categoryList = [];\n    topCategory.map((item) => {\n      item.level = 1;\n      categoryList.push(item);\n      data.map((child) => {\n        if (child.parent_id === item.id) {\n          child.level = 2;\n          categoryList.push(child);\n        }\n      });\n    });\n    return this.success(categoryList);\n  }\n\n  /**\n   * 选出所有的二级分类\n   * @returns {Promise<void>}\n   */\n  async secondAction () {\n    const model = this.model('category');\n    const data = await model.where({is_show: 1}).order(['sort_order ASC']).select();\n    const second = data.filter((item) => {\n      return item.parent_id != 0;\n    })\n    return this.success(second);\n\n  }\n\n  /**\n   * 选出所有的一级分类\n   * @returns {Promise<*|never>}\n   */\n  async topCategoryAction() {\n    const model = this.model('category');\n    const data = await model.where({parent_id: 0}).order(['id ASC']).select();\n\n    return this.success(data);\n  }\n\n  async infoAction() {\n    const id = this.get('id');\n    const model = this.model('category');\n    const data = await model.where({id: id}).find();\n\n    return this.success(data);\n  }\n\n  /**\n   * 保存分类\n   * @returns {Promise<*>}\n   */\n  async storeAction() {\n    if (!this.isPost) {\n      return false;\n    }\n\n    const values = this.post();\n    const id = this.post('id');\n\n    const model = this.model('category');\n    values.is_show = values.is_show ? 1 : 0;\n\n    let datas = {};\n    datas.id = values.id?values.id:0;\n    datas.name = values.name? values.name:'';\n    datas.keywords = values.keywords? values.keywords:'';\n    datas.front_desc = values.front_desc? values.front_desc:'';\n    datas.parent_id = values.parent_id? values.parent_id: 0;\n    datas.sort_order = values.sort_order? values.sort_order: 0;\n    datas.show_index= values.show_index? values.show_index:0;\n    datas.is_show = values.is_show? values.is_show: 0;\n    datas.banner_url = values.banner_url? values.banner_url: '';\n    datas.icon_url = values.icon_url? values.icon_url: '';\n    datas.img_url = values.img_url? values.img_url: '';\n    datas.wap_banner_url = values.wap_banner_url? values.wap_banner_url: '';\n    datas.level = values.level? values.level: '';\n    datas.type = values.type? values.type: 0;\n    datas.front_name = values.front_name? values.front_name:'';\n\n\n    if (id > 0) {\n      await model.where({id: id}).update(datas);\n    } else {\n      delete datas.id;\n      await model.add(datas);\n    }\n    return this.success(datas);\n  }\n\n  async destoryAction() {\n    const id = this.post('id');\n    await this.model('category').where({id: id}).limit(1).delete();\n    // TODO 删除图片\n\n    return this.success();\n  }\n};\n\n"
    ]
}